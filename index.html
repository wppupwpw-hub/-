<!DOCTYPE html>
<html lang="ar">
<head>
    <meta name="google-site-verification" content="dmumT6I5P7_VVnaVGeqQLMow16Ifc6jmopRrL95R1x0" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>محول الصور والنصوص إلى PDF</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');

        body {
            /* Font family will be set dynamically based on language */
            font-family: 'Cairo', sans-serif;
            padding-top: 64px; /* Add padding to body to prevent content from hiding behind the header */
        }
        
        .menu-icon-btn.active .line:nth-child(1) {
            transform: translateY(8px) rotate(45deg);
        }
        .menu-icon-btn.active .line:nth-child(2) {
            opacity: 0;
        }
        .menu-icon-btn.active .line:nth-child(3) {
            transform: translateY(-8px) rotate(-45deg);
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center min-h-screen">

    <!-- Header Section -->
    <header class="fixed top-0 right-0 left-0 bg-blue-600 shadow-md z-50 p-4 flex items-center justify-between text-white">
        <!-- Menu Button (Hamburger) -->
        <button id="menu-btn" class="menu-icon-btn p-2 rounded-full transition-transform duration-300 transform hover:scale-110 focus:outline-none">
            <div class="line w-6 h-0.5 bg-white my-1 transition-all duration-300"></div>
            <div class="line w-6 h-0.5 bg-white my-1 transition-all duration-300"></div>
            <div class="line w-6 h-0.5 bg-white my-1 transition-all duration-300"></div>
        </button>
        
        <!-- Header Title -->
        <h1 id="header-title" class="text-xl font-bold">محول الصور والنصوص إلى PDF</h1>
        
        <!-- Placeholder for symmetry -->
        <div class="w-10"></div>
    </header>

    <!-- Side Menu -->
    <div id="side-menu" class="fixed top-0 right-0 h-full w-64 bg-white shadow-xl z-40 transform translate-x-full transition-transform duration-300 ease-in-out">
        <div class="p-8">
            <h2 id="menu-title" class="text-2xl font-bold text-gray-800 mb-6 border-b pb-4">القائمة الرئيسية</h2>
            <nav class="space-y-4">
                <a href="#" id="home-link" class="block text-gray-700 hover:text-blue-600 font-semibold transition-colors duration-200">الصفحة الرئيسية</a>
                <a href="https://roaring-sprite-ab613f.netlify.app/" id="about-link" class="block text-gray-700 hover:text-blue-600 font-semibold transition-colors duration-200">سياسة الخصوصية</a>
                <a href="https://www.facebook.com/mohtech.itz" id="contact-link" target="_blank" class="block text-gray-700 hover:text-blue-600 font-semibold transition-colors duration-200">تواصل معنا</a>
                <div class="mt-4">
                    <label for="lang-select" class="block text-gray-700 font-semibold mb-2" id="lang-label">تغيير اللغة</label>
                    <select id="lang-select" class="block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="ar">العربية</option>
                        <option value="en">English</option>
                    </select>
                </div>
            </nav>
        </div>
    </div>

    <!-- Main Content Container -->
    <div class="w-full max-w-2xl mt-8 p-4">
        <div class="bg-white rounded-lg shadow-xl p-8 w-full">
            <!-- Tool Selector -->
            <div class="flex justify-center space-x-16 space-x-reverse mb-6" id="tool-selector-container">
                <button id="show-image-tool-btn" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors duration-200 hover:bg-blue-700">
                    تحويل صور
                </button>
                <button id="show-text-tool-btn" class="bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg shadow-md transition-colors duration-200 hover:bg-gray-400">
                    تحويل نص
                </button>
            </div>

            <!-- Image to PDF Tool -->
            <div id="image-tool-container" class="tool-container">
                <div class="text-center mb-6">
                    <p id="image-subtitle" class="text-gray-600 mt-2">اختر صورك (JPG, PNG) لتحويلها إلى مستند PDF واحد.</p>
                </div>
                <!-- File input for multiple images -->
                <div class="mb-6">
                    <label for="image-upload" id="upload-label" class="block text-sm font-medium text-gray-700 mb-2">
                        اختر الصور
                    </label>
                    <input type="file" id="image-upload" accept=".jpg, .jpeg, .png" multiple class="block w-full text-sm text-gray-500
                        file:mr-4 file:py-2 file:px-4
                        file:rounded-full file:border-0
                        file:text-sm file:font-semibold
                        file:bg-blue-50 file:text-blue-700
                        hover:file:bg-blue-100
                        focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                </div>
                <!-- Preview and message area -->
                <div id="image-preview-container" class="mb-6 h-56 overflow-y-auto border border-gray-300 rounded-md p-4">
                    <h3 id="image-preview-title" class="text-lg font-semibold text-gray-700 mb-2 sticky top-0 bg-white z-10">معاينة الصور:</h3>
                    <div id="image-preview" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                        <!-- Image previews will be added here dynamically -->
                    </div>
                    <p id="image-status-message" class="mt-4 text-center text-gray-500"></p>
                </div>
                <!-- PDF Options -->
                <div class="mb-6">
                    <h3 id="image-options-title" class="text-lg font-semibold text-gray-700 mb-2">خيارات PDF</h3>
                    <div class="flex flex-col sm:flex-row sm:space-x-4 sm:space-x-reverse space-y-4 sm:space-y-0">
                        <div>
                            <label for="image-page-format" id="image-format-label" class="block text-sm font-medium text-gray-700">حجم الصفحة</label>
                            <select id="image-page-format" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                <option value="a4">A4</option>
                                <option value="letter">Letter</option>
                            </select>
                        </div>
                        <div>
                            <label for="image-page-orientation" id="image-orientation-label" class="block text-sm font-medium text-gray-700">اتجاه الصفحة</label>
                            <select id="image-page-orientation" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                <option value="portrait" id="image-portrait-option">عمودي</option>
                                <option value="landscape" id="image-landscape-option">أفقي</option>
                            </select>
                        </div>
                    </div>
                </div>
                <!-- Convert button -->
                <button id="image-convert-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-colors duration-200 shadow-md">
                    تحويل إلى PDF
                </button>
            </div>

            <!-- Text to PDF Tool -->
            <div id="text-tool-container" class="tool-container hidden">
                <div class="text-center mb-6">
                    <p id="text-subtitle" class="text-gray-600 mt-2">اكتب النص الخاص بك هنا لتحويله إلى مستند PDF.</p>
                </div>
                <div class="mb-6">
                    <label for="text-input" id="text-label" class="block text-sm font-medium text-gray-700 mb-2">
                        أدخل النص
                    </label>
                    <textarea id="text-input" class="w-full p-3 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" rows="10"></textarea>
                </div>
                <!-- PDF Options -->
                <div class="mb-6">
                    <h3 id="text-options-title" class="text-lg font-semibold text-gray-700 mb-2">خيارات PDF</h3>
                    <div class="flex flex-col sm:flex-row sm:space-x-4 sm:space-x-reverse space-y-4 sm:space-y-0">
                        <div>
                            <label for="text-page-format" id="text-format-label" class="block text-sm font-medium text-gray-700">حجم الصفحة</label>
                            <select id="text-page-format" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                <option value="a4">A4</option>
                                <option value="letter">Letter</option>
                            </select>
                        </div>
                        <div>
                            <label for="text-page-orientation" id="text-orientation-label" class="block text-sm font-medium text-gray-700">اتجاه الصفحة</label>
                            <select id="text-page-orientation" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                <option value="portrait" id="text-portrait-option">عمودي</option>
                                <option value="landscape" id="text-landscape-option">أفقي</option>
                            </select>
                        </div>
                    </div>
                </div>
                <!-- Convert button -->
                <button id="text-convert-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-colors duration-200 shadow-md">
                    تحويل إلى PDF
                </button>
                <p id="text-status-message" class="mt-4 text-center text-gray-500"></p>
            </div>

        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const menuBtn = document.getElementById('menu-btn');
            const sideMenu = document.getElementById('side-menu');
            const langSelect = document.getElementById('lang-select');
            
            const showImageToolBtn = document.getElementById('show-image-tool-btn');
            const showTextToolBtn = document.getElementById('show-text-tool-btn');
            const imageToolContainer = document.getElementById('image-tool-container');
            const textToolContainer = document.getElementById('text-tool-container');
            const toolSelectorContainer = document.getElementById('tool-selector-container');

            // Select all elements that need translation
            const elements = {
                headerTitle: document.getElementById('header-title'),
                menuTitle: document.getElementById('menu-title'),
                homeLink: document.getElementById('home-link'),
                aboutLink: document.getElementById('about-link'),
                contactLink: document.getElementById('contact-link'),
                langLabel: document.getElementById('lang-label'),
                showImageToolBtn: showImageToolBtn,
                showTextToolBtn: showTextToolBtn,
                // Image tool elements
                imageSubtitle: document.getElementById('image-subtitle'),
                uploadLabel: document.getElementById('upload-label'),
                imagePreviewTitle: document.getElementById('image-preview-title'),
                imageOptionsTitle: document.getElementById('image-options-title'),
                imageFormatLabel: document.getElementById('image-format-label'),
                imageOrientationLabel: document.getElementById('image-orientation-label'),
                imagePortraitOption: document.getElementById('image-portrait-option'),
                imageLandscapeOption: document.getElementById('image-landscape-option'),
                imageConvertBtn: document.getElementById('image-convert-btn'),
                // Text tool elements
                textSubtitle: document.getElementById('text-subtitle'),
                textLabel: document.getElementById('text-label'),
                textOptionsTitle: document.getElementById('text-options-title'),
                textFormatLabel: document.getElementById('text-format-label'),
                textOrientationLabel: document.getElementById('text-orientation-label'),
                textPortraitOption: document.getElementById('text-portrait-option'),
                textLandscapeOption: document.getElementById('text-landscape-option'),
                textConvertBtn: document.getElementById('text-convert-btn'),
            };

            // Translation content
            const translations = {
                ar: {
                    direction: 'rtl',
                    fontFamily: 'Cairo',
                    toolSelectorClass: 'space-x-16 space-x-reverse',
                    title: 'محول الصور والنصوص إلى PDF',
                    menuTitle: 'القائمة الرئيسية',
                    homeLink: 'الصفحة الرئيسية',
                    aboutLink: 'سياسة الخصوصية',
                    contactLink: 'تواصل معنا',
                    langLabel: 'تغيير اللغة',
                    showImageToolBtn: 'تحويل صور',
                    showTextToolBtn: 'تحويل نص',
                    // Image tool
                    imageSubtitle: 'اختر صورك (JPG, PNG) لتحويلها إلى مستند PDF واحد.',
                    uploadLabel: 'اختر الصور',
                    imagePreviewTitle: 'معاينة الصور:',
                    imageStatusMessage: 'لم يتم اختيار أي صور.',
                    imageOptionsTitle: 'خيارات PDF',
                    imageFormatLabel: 'حجم الصفحة',
                    imageOrientationLabel: 'اتجاه الصفحة',
                    imagePortraitOption: 'عمودي',
                    imageLandscapeOption: 'أفقي',
                    imageConvertBtn: 'تحويل إلى PDF',
                    imageNoImagesMessage: 'لم يتم اختيار أي صور.',
                    imageNoSupportedImagesMessage: 'لم يتم اختيار أي صور مدعومة (JPG, PNG).',
                    imagesSelectedMessage: (count) => `تم اختيار ${count} صورة.`,
                    imagePleaseSelectImageMessage: 'الرجاء اختيار صورة واحدة على الأقل لتحويلها.',
                    imageConvertingMessage: 'يتم التحويل... الرجاء الانتظار.',
                    imageConversionSuccessMessage: 'تم التحويل بنجاح! يتم تنزيل ملف PDF.',
                    // Text tool
                    textSubtitle: 'اكتب النص الخاص بك هنا لتحويله إلى مستند PDF.',
                    textLabel: 'أدخل النص',
                    textOptionsTitle: 'خيارات PDF',
                    textFormatLabel: 'حجم الصفحة',
                    textOrientationLabel: 'اتجاه الصفحة',
                    textPortraitOption: 'عمودي',
                    textLandscapeOption: 'أفقي',
                    textConvertBtn: 'تحويل إلى PDF',
                    textNoTextMessage: 'الرجاء إدخال بعض النص لتحويله.',
                    textConvertingMessage: 'يتم التحويل... الرجاء الانتظار.',
                    textConversionSuccessMessage: 'تم التحويل بنجاح! يتم تنزيل ملف PDF.'
                },
                en: {
                    direction: 'ltr',
                    fontFamily: 'Inter',
                    toolSelectorClass: 'space-x-16',
                    title: 'Image & Text to PDF Converter',
                    menuTitle: 'Main Menu',
                    homeLink: 'Home',
                    aboutLink: 'Privacy Policy',
                    contactLink: 'Contact Us',
                    langLabel: 'Change Language',
                    showImageToolBtn: 'Convert Images',
                    showTextToolBtn: 'Convert Text',
                    // Image tool
                    imageSubtitle: 'Select your images (JPG, PNG) to convert them into a single PDF document.',
                    uploadLabel: 'Choose Images',
                    imagePreviewTitle: 'Image Preview:',
                    imageStatusMessage: 'No images selected.',
                    imageOptionsTitle: 'PDF Options',
                    imageFormatLabel: 'Page Size',
                    imageOrientationLabel: 'Page Orientation',
                    imagePortraitOption: 'Portrait',
                    imageLandscapeOption: 'Landscape',
                    imageConvertBtn: 'Convert to PDF',
                    imageNoImagesMessage: 'No images selected.',
                    imageNoSupportedImagesMessage: 'No supported images (JPG, PNG) were selected.',
                    imagesSelectedMessage: (count) => `${count} image(s) selected.`,
                    imagePleaseSelectImageMessage: 'Please select at least one image to convert.',
                    imageConvertingMessage: 'Converting... Please wait.',
                    imageConversionSuccessMessage: 'Conversion successful! Downloading PDF file.',
                    // Text tool
                    textSubtitle: 'Type your text here to convert it into a PDF document.',
                    textLabel: 'Enter Text',
                    textOptionsTitle: 'PDF Options',
                    textFormatLabel: 'Page Size',
                    textOrientationLabel: 'Page Orientation',
                    textPortraitOption: 'Portrait',
                    textLandscapeOption: 'Landscape',
                    textConvertBtn: 'Convert to PDF',
                    textNoTextMessage: 'Please enter some text to convert.',
                    textConvertingMessage: 'Converting... Please wait.',
                    textConversionSuccessMessage: 'Conversion successful! Downloading PDF file.'
                }
            };

            let currentLang = 'ar';
            const imageStatusMessageElement = document.getElementById('image-status-message');
            const textStatusMessageElement = document.getElementById('text-status-message');

            const updateText = (lang) => {
                document.documentElement.lang = lang;
                document.body.style.direction = translations[lang].direction;
                document.body.style.fontFamily = `'${translations[lang].fontFamily}', sans-serif`;
                document.title = translations[lang].title;
                document.getElementById('header-title').textContent = translations[lang].title;
                toolSelectorContainer.className = `flex justify-center mb-6 ${translations[lang].toolSelectorClass}`;

                for (const key in elements) {
                    if (elements[key]) {
                        if (translations[lang][key]) {
                            elements[key].textContent = translations[lang][key];
                        }
                    }
                }
                
                // Update status messages explicitly
                imageStatusMessageElement.textContent = translations[lang].imageNoImagesMessage;
                textStatusMessageElement.textContent = '';
                
                // Update select options text
                document.getElementById('image-portrait-option').textContent = translations[lang].imagePortraitOption;
                document.getElementById('image-landscape-option').textContent = translations[lang].imageLandscapeOption;
                document.getElementById('text-portrait-option').textContent = translations[lang].textPortraitOption;
                document.getElementById('text-landscape-option').textContent = translations[lang].textLandscapeOption;
            };

            // Toggle side menu visibility
            menuBtn.addEventListener('click', () => {
                sideMenu.classList.toggle('translate-x-full');
                menuBtn.classList.toggle('active');
            });

            // Language switch functionality using the new select element
            langSelect.addEventListener('change', (e) => {
                currentLang = e.target.value;
                updateText(currentLang);
                sideMenu.classList.add('translate-x-full');
                menuBtn.classList.remove('active');
            });

            // Tool switching logic
            showImageToolBtn.addEventListener('click', () => {
                imageToolContainer.classList.remove('hidden');
                textToolContainer.classList.add('hidden');
                showImageToolBtn.classList.remove('bg-gray-300', 'text-gray-800');
                showImageToolBtn.classList.add('bg-blue-600', 'text-white');
                showTextToolBtn.classList.remove('bg-blue-600', 'text-white');
                showTextToolBtn.classList.add('bg-gray-300', 'text-gray-800');
            });

            showTextToolBtn.addEventListener('click', () => {
                textToolContainer.classList.remove('hidden');
                imageToolContainer.classList.add('hidden');
                showTextToolBtn.classList.remove('bg-gray-300', 'text-gray-800');
                showTextToolBtn.classList.add('bg-blue-600', 'text-white');
                showImageToolBtn.classList.remove('bg-blue-600', 'text-white');
                showImageToolBtn.classList.add('bg-gray-300', 'text-gray-800');
            });
            
            // Image to PDF Logic
            const imageUpload = document.getElementById('image-upload');
            const imageConvertBtn = document.getElementById('image-convert-btn');
            const imagePreview = document.getElementById('image-preview');
            const imagePageFormat = document.getElementById('image-page-format');
            const imagePageOrientation = document.getElementById('image-page-orientation');
            
            let imageFiles = [];

            imageUpload.addEventListener('change', (event) => {
                const files = Array.from(event.target.files);
                imageFiles = [];
                imagePreview.innerHTML = '';
                imageStatusMessageElement.textContent = '';

                if (files.length === 0) {
                    imageStatusMessageElement.textContent = translations[currentLang].imageNoImagesMessage;
                    return;
                }

                files.forEach(file => {
                    if (file.type.startsWith('image/')) {
                        imageFiles.push(file);
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const imgContainer = document.createElement('div');
                            imgContainer.className = 'relative group';
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.className = 'w-full h-auto object-cover rounded-md shadow-md transform transition-transform duration-200 group-hover:scale-105';
                            img.alt = 'Image preview';
                            imgContainer.appendChild(img);
                            imagePreview.appendChild(imgContainer);
                        };
                        reader.readAsDataURL(file);
                    }
                });

                if (imageFiles.length > 0) {
                    imageStatusMessageElement.textContent = translations[currentLang].imagesSelectedMessage(imageFiles.length);
                } else {
                    imageStatusMessageElement.textContent = translations[currentLang].imageNoSupportedImagesMessage;
                }
            });

            imageConvertBtn.addEventListener('click', async () => {
                if (imageFiles.length === 0) {
                    imageStatusMessageElement.textContent = translations[currentLang].imagePleaseSelectImageMessage;
                    return;
                }

                imageStatusMessageElement.textContent = translations[currentLang].imageConvertingMessage;
                imageConvertBtn.disabled = true;

                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({
                    orientation: imagePageOrientation.value === 'landscape' ? 'l' : 'p',
                    unit: 'mm',
                    format: imagePageFormat.value,
                });

                for (let i = 0; i < imageFiles.length; i++) {
                    const file = imageFiles[i];
                    const reader = new FileReader();
                    reader.readAsDataURL(file);

                    await new Promise(resolve => {
                        reader.onload = (e) => {
                            const imgData = e.target.result;
                            const img = new Image();
                            img.onload = () => {
                                if (i > 0) {
                                    doc.addPage();
                                }
                                const imgWidth = img.width;
                                const imgHeight = img.height;
                                const pageWidth = doc.internal.pageSize.getWidth();
                                const pageHeight = doc.internal.pageSize.getHeight();
                                const ratio = Math.min(pageWidth / imgWidth, pageHeight / imgHeight);
                                const newWidth = imgWidth * ratio;
                                const newHeight = imgHeight * ratio;
                                const x = (pageWidth - newWidth) / 2;
                                const y = (pageHeight - newHeight) / 2;
                                doc.addImage(imgData, 'JPEG', x, y, newWidth, newHeight);
                                resolve();
                            };
                            img.src = imgData;
                        };
                    });
                }

                doc.save('converted-images.pdf');
                imageStatusMessageElement.textContent = translations[currentLang].imageConversionSuccessMessage;
                imageConvertBtn.disabled = false;
            });
            
            // Text to PDF Logic
            const textInput = document.getElementById('text-input');
            const textConvertBtn = document.getElementById('text-convert-btn');
            const textPageFormat = document.getElementById('text-page-format');
            const textPageOrientation = document.getElementById('text-page-orientation');
            
            textConvertBtn.addEventListener('click', async () => {
                const text = textInput.value.trim();
                if (text.length === 0) {
                    textStatusMessageElement.textContent = translations[currentLang].textNoTextMessage;
                    return;
                }

                textStatusMessageElement.textContent = translations[currentLang].textConvertingMessage;
                textConvertBtn.disabled = true;

                const { jsPDF } = window.jspdf;

                // Create a temporary element to capture the text
                const tempDiv = document.createElement('div');
                tempDiv.textContent = text;
                tempDiv.style.fontFamily = 'Cairo, sans-serif'; // Use a web font for rendering
                tempDiv.style.direction = document.body.style.direction; // Set direction for proper rendering
                tempDiv.style.width = '190mm'; // Set a fixed width to control line breaks
                tempDiv.style.padding = '10mm';
                tempDiv.style.backgroundColor = 'white';
                tempDiv.style.position = 'absolute';
                tempDiv.style.top = '-9999px';
                document.body.appendChild(tempDiv);
                
                try {
                    const canvas = await html2canvas(tempDiv);

                    const doc = new jsPDF({
                        orientation: textPageOrientation.value === 'landscape' ? 'l' : 'p',
                        unit: 'mm',
                        format: textPageFormat.value,
                    });

                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = doc.internal.pageSize.getWidth() - 20;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;

                    doc.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);

                    doc.save('converted-text.pdf');
                    textStatusMessageElement.textContent = translations[currentLang].textConversionSuccessMessage;
                } catch (error) {
                    console.error('Error during text conversion:', error);
                    textStatusMessageElement.textContent = 'حدث خطأ أثناء تحويل النص.';
                } finally {
                    document.body.removeChild(tempDiv);
                    textConvertBtn.disabled = false;
                }
            });

            // Initial text update based on the default language
            updateText(currentLang);
        });
    </script>
</body>
</html>
